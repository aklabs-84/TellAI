<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 활용 계획 작성</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen py-8 px-4">
    <div class="max-w-3xl mx-auto">
        <!-- 헤더 -->
        <div class="bg-white rounded-2xl shadow-lg p-8 mb-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">🤖 AI 활용 계획 작성</h1>
            <p class="text-gray-600">인공지능을 업무에 어떻게 활용하고 싶으신가요?</p>
        </div>

        <!-- 메인 폼 -->
        <form id="aiPlanForm" class="bg-white rounded-2xl shadow-lg p-8 space-y-6">
            <!-- 이름 -->
            <div>
                <label for="name" class="block text-sm font-semibold text-gray-700 mb-2">
                    이름 <span class="text-red-500">*</span>
                </label>
                <input 
                    type="text" 
                    id="name" 
                    name="name" 
                    required
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition"
                    placeholder="홍길동"
                >
            </div>

            <!-- 소속/직급 -->
            <div>
                <label for="position" class="block text-sm font-semibold text-gray-700 mb-2">
                    소속 / 직급
                </label>
                <input 
                    type="text" 
                    id="position" 
                    name="position"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition"
                    placeholder="예: 마케팅팀 / 대리"
                >
            </div>

            <!-- AI 활용 목적 -->
            <div>
                <label for="purpose" class="block text-sm font-semibold text-gray-700 mb-2">
                    AI를 어떤 업무에 활용하고 싶으신가요? <span class="text-red-500">*</span>
                </label>
                <textarea 
                    id="purpose" 
                    name="purpose" 
                    required
                    rows="4"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition resize-none"
                    placeholder="예: 고객 문의 자동 응답 시스템 구축, 보고서 작성 자동화 등"
                ></textarea>
            </div>

            <!-- 해결하고 싶은 문제 -->
            <div>
                <label for="problem" class="block text-sm font-semibold text-gray-700 mb-2">
                    어떤 문제를 해결하고 싶으신가요? <span class="text-red-500">*</span>
                </label>
                <textarea 
                    id="problem" 
                    name="problem" 
                    required
                    rows="5"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition resize-none"
                    placeholder="현재 겪고 있는 문제점이나 개선하고 싶은 업무 프로세스를 구체적으로 작성해주세요."
                ></textarea>
            </div>

            <!-- 기대 효과 -->
            <div>
                <label for="expectation" class="block text-sm font-semibold text-gray-700 mb-2">
                    AI 활용을 통해 기대하는 효과
                </label>
                <textarea 
                    id="expectation" 
                    name="expectation"
                    rows="4"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition resize-none"
                    placeholder="예: 업무 시간 50% 단축, 고객 만족도 향상 등"
                ></textarea>
            </div>

            <!-- 추가 의견 -->
            <div>
                <label for="additional" class="block text-sm font-semibold text-gray-700 mb-2">
                    기타 의견 및 질문
                </label>
                <textarea 
                    id="additional" 
                    name="additional"
                    rows="3"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition resize-none"
                    placeholder="궁금한 점이나 추가로 전달하고 싶은 내용을 자유롭게 작성해주세요."
                ></textarea>
            </div>

            <!-- 제출 버튼 -->
            <div class="pt-4">
                <button 
                    type="submit" 
                    id="submitBtn"
                    class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-4 px-6 rounded-lg transition duration-200 shadow-md hover:shadow-lg"
                >
                    제출하기
                </button>
            </div>
        </form>

        <!-- 성공 메시지 -->
        <div id="successMessage" class="hidden bg-green-50 border-2 border-green-500 rounded-2xl p-6 mt-6">
            <div class="flex items-center">
                <svg class="w-6 h-6 text-green-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <p class="text-green-800 font-semibold">제출이 완료되었습니다! 감사합니다.</p>
            </div>
        </div>

        <!-- 에러 메시지 -->
        <div id="errorMessage" class="hidden bg-red-50 border-2 border-red-500 rounded-2xl p-6 mt-6">
            <div class="flex items-center">
                <svg class="w-6 h-6 text-red-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
                <p class="text-red-800 font-semibold">제출 중 오류가 발생했습니다. 다시 시도해주세요.</p>
            </div>
        </div>
    </div>

    <script>
        // ⚠️ 여기에 Google Apps Script 웹앱 URL을 입력하세요
        const GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwwQyne4bC-PmnrA39-0RNh0IWEjRwy3aXMlZ817ouOQfFFIl9UiEi3NFmNtqL3FV6s/exec';

        const form = document.getElementById('aiPlanForm');
        const submitBtn = document.getElementById('submitBtn');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // 버튼 비활성화
            submitBtn.disabled = true;
            submitBtn.textContent = '제출 중...';
            submitBtn.classList.add('opacity-50', 'cursor-not-allowed');

            // 메시지 숨기기
            successMessage.classList.add('hidden');
            errorMessage.classList.add('hidden');

            try {
                // 현재 시간
                const currentDate = new Date();
                const formattedDate = currentDate.toLocaleString('ko-KR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });

                // 폼 데이터 수집
                const formData = {
                    timestamp: formattedDate,
                    name: document.getElementById('name').value,
                    position: document.getElementById('position').value,
                    purpose: document.getElementById('purpose').value,
                    problem: document.getElementById('problem').value,
                    expectation: document.getElementById('expectation').value,
                    additional: document.getElementById('additional').value
                };

                // Google Apps Script로 전송
                const response = await fetch(GOOGLE_APPS_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),
                    mode: 'no-cors'
                });

                // 성공 메시지 표시
                successMessage.classList.remove('hidden');
                form.reset();

                // 3초 후 성공 메시지 숨기기
                setTimeout(() => {
                    successMessage.classList.add('hidden');
                }, 5000);

            } catch (error) {
                console.error('제출 오류:', error);
                errorMessage.classList.remove('hidden');
            } finally {
                // 버튼 활성화
                submitBtn.disabled = false;
                submitBtn.textContent = '제출하기';
                submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        });
    </script>
</body>
</html>